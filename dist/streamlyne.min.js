!function(a,b,c,d,e){self=a;self.version="0.0.1",self.connect=function(){return new f(arguments[0])};var f=function(a){console.log("Creating Steamlyne Connection");var b=f,c=null,d=null,e=null,g=null;return b.prototype.loadOptions=function(a){return a.host&&(d=a.host),a.email&&(e=a.email),a.token&&(g=a.token),this},b.prototype.apiRequest=function(a,b,f,h){if(console.log("Streamlyne API Request: ",arguments),!d){var i=new Error("Streamlyne Server Host URL not yet specified.");return h&&h(i,null),this}b||(b=""),f||(f={}),c||(c={}),e&&g&&(c["x-sl-email"]=e,c["x-sl-token"]=g),c["Content-Type"]="application/json",console.log(c);var j=d+"api/"+b+("GET"==a?"?p="+JSON.stringify(f):""),k={},l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");console.log(a),l.open(a,j,!0);for(var m in c){var n=c[m];l.setRequestHeader(m,n)}return l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){console.log("Finished and OK!");var a=l.responseText;k=JSON.parse(a),console.log(k),h&&h(null,k)}},l.send(JSON.stringify(f)),this},this.loadOptions(a),this},g=function(a){return this.connection=a,{data:{method:"GET",path:"",query:{}},doneCallbacks:[],clear:function(){return this.clearQuery(),this},clearQuery:function(){return this.data={method:"GET",path:"",query:{}},this},connection:function(a){this.connection=a},read:function(a){return this.data.method="GET",this.data.path=a,this},query:function(a){return this.data.query=a||this.data.query||{},this},filter:function(a){return this.data.query=this.data.query||{},this.data.query.filter=a||this.data.query.filter||{},this},filterFields:function(a){return this.data.query=this.data.query||{},this.data.query.filter=this.data.query.filter||{},this.data.query.filter.fields=a||this.data.query.filter.fields||!0,this},filterRelationships:function(a){return this.data.query=this.data.query||{},this.data.query.filter=this.data.query.filter||{},this.data.query.filter.rels=a||this.data.query.filter.rels||!0,this},limit:function(a){return this.data.query=this.data.query||{},this.data.query.page=this.data.query.page||{},this.data.query.page.count=a||this.data.query.page.count||0,this},getPageWithId:function(a){return this.data.query=this.data.query||{},this.data.query.page=this.data.query.page||{},this.data.query.page.id=a||this.data.query.page.id||0,this},done:function(a){return console.log(this.doneCallbacks),null!==a&&this.doneCallbacks.push(a),this},run:function(a){if(connection===e)return console.log("Requires a StreamlyneConnection."),{};if(this.data&&this.data.method&&this.data.path&&this.data.query){this.done(a);var b=this;connection.apiRequest(this.data.method,this.data.path,this.data.query,function(a,c){if(console.log("API Request:",a,c),console.log(b.doneCallbacks),b.doneCallbacks){b.doneCallbacks.reverse();for(var d=0,e=b.doneCallbacks.length;e>d;d++){var f=b.doneCallbacks.pop();f(a,c)}}b.doneCallbacks=[]})}else console.log("Does not meet requirements.",this.data);return this}}};b.StreamlyneRequest=g;var h=function(){console.log("Creating Streamlyne Node");var a=this;a.data={},a.relationships={},a.readAll=function(a,b){return g(a).read(this.type()+"/").filterFields(!0).filterRelationships(!0).run(function(a,c){console.log("Request Complete: ",a,c);var d=c.nodes;console.log(d);for(var e=0,f=d.length;f>e;e++){var g=d[e];console.log(g)}b&&b(null,c)}),this},a.readWithId=function(a,b,c){return g(a).read(this.type()+"/"+b).filterFields(!0).filterRelationships(!0).run(function(a,b){console.log("Request Complete: ",a,b);var d=b;console.log(d),c&&c(null,b)}),this},a.readById=a.readWithId;var b={};return a.db=function(){var a=b[this.type()];return a===e&&(a=c(),b[this.type()]=a),a},a};b.StreamlyneNode=h;var i=function(){var a=this;return a=new h,console.log(a.prototype),a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return console.log("testUserFunction"),this},a};b.StreamlyneUser=i;var j=function(){var a=this;return a=new h,console.log(a.prototype),a.type=function(){return"workOrder"},a.customUserClassOnlyFun=function(){return console.log("testUserFunction"),this},a};return b.StreamlyneWorkOrder=j,self}(window.Streamlyne=window.Streamlyne||{},window,TAFFY,moment);