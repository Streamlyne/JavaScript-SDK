!function(a,b,c,d,e){var f=a;f.version="0.0.1",f.connect=function(){return new g(arguments[0])};var g=function(a){var b=this,c=null,d=null,e=null,f=null;return b.loadOptions=function(a){return a.host&&(d=a.host),a.email&&(e=a.email),a.token&&(f=a.token),this},b.apiRequest=function(a,g,h,i){if(!d){var j=new Error("Streamlyne Server Host URL not yet specified.");return i&&i(j,null),this}g||(g=""),h||(h={}),c||(c={}),e&&f&&(c["x-sl-email"]=e,c["x-sl-token"]=f),c["Content-Type"]="application/json";var k=d+"api/"+g+("GET"===a?"?p="+JSON.stringify(h):""),l={},m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");m.open(a,k,!0);for(var n in c){var o=c[n];m.setRequestHeader(n,o)}var p=function(a,b){return 4===a&&2===parseInt(b/100)};return m.onreadystatechange=function(){var a=m.responseText;if(p(m.readyState,m.status))return l=JSON.parse(a),i&&i(null,l);if(4===m.readyState)try{return l=JSON.parse(a),i&&i(c,l)}catch(b){var c=new Error(a);return i&&i(c,{})}},m.send(JSON.stringify(h)),b},b.authenticate=function(a,c,d){return b.apiRequest("POST","authenticate",{email:a,password:c},function(a,c){return a||b.loadOptions({email:c.email,token:c.token}),d&&d(a,b)}),b},b.loadOptions(a),b.display=function(){return b},b},h=function(a){var b=this;return this instanceof h?(b.connection=null,b.data={method:"GET",path:"",query:{}},b.doneCallbacks=[],b.clear=function(){return this.clearQuery(),this},b.clearQuery=function(){return this.data={method:"GET",path:"",query:{}},this},b.setConnection=function(a){return this.connection=a,this},b.read=function(a){return this.data.method="GET",this.data.path=a,this},b.create=function(a){return this.data.method="POST",this.data.path=a,this},b.query=function(a){return this.data.query=a||this.data.query||{},this},b.filter=function(a){return this.data.query=this.data.query||{},this.data.query.filter=a||this.data.query.filter||{},this},b.filterFields=function(a){return this.data.query=this.data.query||{},this.data.query.filter=this.data.query.filter||{},this.data.query.filter.fields=a||this.data.query.filter.fields||!0,this},b.filterRelationships=function(a){return this.data.query=this.data.query||{},this.data.query.filter=this.data.query.filter||{},this.data.query.filter.rels=a||this.data.query.filter.rels||!0,this},b.limit=function(a){return this.data.query=this.data.query||{},this.data.query.page=this.data.query.page||{},this.data.query.page.count=a||this.data.query.page.count||0,this},b.getPageWithId=function(a){return this.data.query=this.data.query||{},this.data.query.page=this.data.query.page||{},this.data.query.page.id=a||this.data.query.page.id||0,this},b.done=function(a){return null!==a&&this.doneCallbacks.push(a),this},b.run=function(a){if(this.connection.display(),this.connection===e)return{};if(this.data&&this.data.method&&this.data.path&&this.data.query){this.done(a);var b=this;this.connection.apiRequest(this.data.method,this.data.path,this.data.query,function(a,c){if(b.doneCallbacks){b.doneCallbacks.reverse();for(var d=0,e=b.doneCallbacks.length;e>d;d++){var f=b.doneCallbacks.pop();f(a,c)}}b.doneCallbacks=[]})}return this},b.setConnection(a),b):new h(a)};b.StreamlyneRequest=h;var i=function(){var a=this;a.data={},a.relationships={},a.readAll=function(a,b){return new h(a).read(this.type()+"/").filterFields(!0).filterRelationships(!0).run(function(a,c){try{return b&&b(null,c)}catch(d){return b&&b(d,[])}}),this},a.readWithId=function(a,b,c){return new h(a).read(this.type()+"/"+b).filterFields(!0).filterRelationships(!0).run(function(a,b){return c&&c(null,b)}),this},a.readById=a.readWithId,a.create=function(a,b,c){return b=b||{},new h(a).create(this.type()).query({data:b.data||{},rels:b.relationships||[]}).run(function(a,b){return c&&c(a,b)}),this};var b={};return a.db=function(){var a=b[this.type()];return a===e&&(a=c(),b[this.type()]=a),a},a};b.StreamlyneNode=i;var j=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneUser=j,a.user=new j;var k=function(){var a=this;return a=new i,a.type=function(){return"workOrder"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneWorkOrder=k,a.workOrder=new k;var l=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneAsset=l,a.asset=new l;var m=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneGroup=m,a.group=new m;var n=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneLog=n,a.log=new n;var o=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneAttribute=o,a.attribute=new o;var p=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};b.StreamlyneOrganization=p,a.organization=new p;var q=function(){var a=this;return a=new i,a.type=function(){return"user"},a.customUserClassOnlyFun=function(){return this},a};return b.StreamlyneSite=q,a.site=new q,f}(window.Streamlyne=window.Streamlyne||{},window,TAFFY,moment);